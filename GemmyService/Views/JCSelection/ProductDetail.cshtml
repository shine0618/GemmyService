
@{
    ViewBag.Title = "ProductDetail";
}

<style>
    #shjahs {
        width: 100%;
        border: 0;
        margin: 0;
        padding: 0;
        height: 620px;
        width: 830px;
        /*      min-height:550px;
        height: calc(100vh - 280px);*/
    }

    #asas {
        margin: 0;
        padding: 0;
    }

    .about-three {
        padding-top: 20px;
        padding-bottom: 0px;
    }

    * {
        font-family: 'Microsoft YaHei'
    }
    /*    .block-title h6{
        text-align:left;
    }*/
    .block-title {
        margin-top: 30px;
        margin-bottom: 5px;
    }

    .fa-qrcode {
        width: 120px;
        height: 120px;
    }

    .selectColor_span {
        display: block;
        width: 40px;
        height: 40px;
        border-radius: 20px;
        margin: 3px;
        margin-left: 150px;
    }

    #FilesBox {
    }

    .filerow {
        margin-bottom: 5px;
    }
    /*.el-tabs__nav-wrap {
        width: 720px;

    }*/
    /*.el-tab-pane {
        width: 50% !important;
        margin: 0 auto !important;
        font-size: 30px !important;
    }*/
    /*.el-tabs el-tabs--top {
        width: 720px;

        vertical-align: center;
    }*/
    /*.el-tabs__nav-scroll {
        width: 50% !important;
        margin: 0 auto !important;
    }*/
    .el-tabs__item {
        font-size: 18px !important;
    }

    .paramDatatableIMG {
        width: 150px;
        padding: 5px;
    }


    .filethumbnail {
        width: 100%;
        max-width: 100px;
        margin-left:60px;
    }

    .collect_icon {
        width: 50px;
    }
    .titleh5
    {
        margin-top:25px;
        margin-bottom:15px;
    }
</style>

<!-- /.js  加载ele组件 -->
<div id="OfficeStandards">


    <section class="page-header" style="height:53px;">

        @*<div class="page-header__bg" style="background-image: url(/assets/images/backgrounds/page-header-bg-1-1.jpg);"></div>*@
        <!-- /.page-header__bg -->
        <div class="container" style="padding:10px 10px ">
            <a class="navigation_a" href="/JCSelection/main">{{NAVMainPage}}</a>/
            <a class="navigation_a" href="/JCSelection/office">{{NAVOfficePage}}</a>/
            <a class="navigation_a" href="/JCSelection/OfficeStandards?domain=office&Type=@ViewBag.Type&recommend=@ViewBag.recommend">@ViewBag.Type</a>/
            <a class="navigation_a">{{NAVProductDetailPage}}</a>
        </div><!-- /.container -->
    </section><!-- /.page-header -->



    <section class="about-three">
        <div class="container">
            <div class="row">

                <div class="container">
                    <div class="row">
                        <div class="col-lg-9 col-md-12 col-xs-12" id="asas">

                        </div>
                        <div class="col-lg-3 col-md-9 col-xs-9">
                            @*<i v-show="isCollect" class="el-icon-star-on collect_icon" @@click="isCollect=!isCollect"></i>
                                <i v-show="!isCollect" class="el-icon-star-off collect_icon" @@click="isCollect=!isCollect"></i>*@

                            <div>
                                <img src="~/resourse/other/collect1.png" v-if="isCollect==true" class="img-response collect_icon" @@click="CancelCollectDesk" />
                                <img src="~/resourse/other/collect0.png" v-else class="img-response collect_icon" @@click="CollectDesk" />
                            </div>

                            <div class="about-three__image">

                                <h4 class="drawerh5" v-text="deskSerialName"></h4>
                                <br />
                                <h5 v-text="introduction" class="titleh5"></h5>
                              
                                <!--<div class="block-title text-left">
        <p>{{text_detail_1}}</p>
        <h6 v-text="deskSerialName"></h6>
    </div>-->
                                <!-- /.block-title -->
                                <!--<div class="block-title text-left">
        <p>产品介绍</p>

    </div>-->

                                <h6 v-for="item in descriptions" v-text="item"></h6>
                                <!-- /.block-title 关键参数 -->
                                <!--<div class="block-title text-left">
        <p>{{text_detail_2}}</p>

    </div>-->
                                <!-- /.block-title -->

                               
                                <h5 v-text="text_detail_3" class="titleh5"></h5>
                              
                                <h6 v-text="configurationNo"></h6>

                                <!--<div class="block-title text-left">
        <img src="~/resourse/page/testqrcode.png" class="fa-qrcode" />

    </div>-->
                                <!-- /.block-title -->
                                <div style="padding-top:30px" id="qrcodebox"></div>


                                @*   <button class="thm-btn">自定义</button>*@
                            </div><!-- /.about-three__image -->
                        </div><!-- /.col-lg-8 -->
                    </div><!-- /.row -->

                </div><!-- /.container -->
            </div>
        </div>
    </section>

    <section class="blog-page pt-20 pb-40">
        <div class="container" id="pdfDom">
            <div class="row">
                <div class="col-lg-12">
                    <div class="block-title text-center">
                        <p></p>
                        <h3>{{ProductConfigurationList}}</h3>
                    </div><!-- /.block-title -->
                    <div>
                        @if (Session["emailName"] != null && Session["emailName"].ToString() != "")
                        {
                            <button class="orderbtn thm-btn" @@click="gotoCustmer" style="float:right;margin-bottom:5px;margin-left:5px">{{ProductConfigurationCustomButton}}</button>
                        }
                            <button class="orderbtn thm-btn" @@click="download()" style="float:right;margin-bottom:5px;">{{ProductExportConfigurationButton}}</button>
                        
                    </div>
                </div>

                <div class="col-lg-12">
                    <table id="paramTB" border="1" style="display:none">
                        <tr>
                            <th v-text="text_detail_8"></th>
                            <th v-text="text_detail_8"></th>
                            <th v-text="text_detail_9"></th>
                            <th v-text="text_detail_10"></th>
                        </tr>
                        <tr v-for="item in paramTableData">
                            <td v-text="item.part"></td>
                            <td>
                                <img class="paramDatatableIMG img-response" :src="item.tag" />

                            </td>
                            <td v-text="item.model"></td>
                            <td>
                                <li style="text-align:left" v-for="itemt in item.paramList" v-text="itemt"></li>
                            </td>
                        </tr>

                    </table>
                    <el-table :data="paramTableData"
                              border>

                        <el-table-column prop="part"
                                         :label="text_detail_8"
                                         align="center"
                                         width="100">
                        </el-table-column>


                        <el-table-column prop="tag"
                                         :label="text_detail_8"
                                         align="center">
                            <template #default="scope">
                                <img v-if="scope.row.name!='1'" class="paramDatatableIMG img-response" :src="scope.row.tag" />
                                <span v-if="scope.row.name=='1'" :style="{ 'background-color':scope.row.tag}" class="selectColor_span"></span>
                            </template>
                        </el-table-column>


                        <el-table-column prop="model"
                                         :label="text_detail_9"
                                         align="center"
                                          width="180">
                        </el-table-column>
                        <el-table-column prop="name"
                                         :label="text_detail_10"
                                         align="center">

                            <template #default="scope">
                                <li style="text-align:left" v-for="item in scope.row.paramList" v-text="item"></li>
                            </template>

                        </el-table-column>





                    </el-table>
                </div>

            </div>
        </div>
    </section>



    <section class="blog-page pt-20 pb-120">
        <div class="container">
            <div class="row" id="FilesBox">
                <div class="col-lg-12">
                    <div class="block-title text-center">
                        <p></p>
                        <h3>{{ProductFilesAndDesc}}</h3>
                    </div><!-- /.block-title -->
                </div>

                <div class="col-lg-12">

                    <div id="app">
                        <template>
                            <el-tabs v-model="activeName" @@tab-click="handleClick" stretch>
                                @*<el-tab-pane :label="text_detail_4" name="d1"></el-tab-pane>*@
                                <el-tab-pane :label="text_detail_5" name="d2"></el-tab-pane>
                                <el-tab-pane :label="text_detail_6" name="d3"></el-tab-pane>
                                <el-tab-pane :label="text_detail_7" name="d4"></el-tab-pane>
                            </el-tabs>
                        </template>
                    </div>

                </div>


            </div>


            <div v-if="activeName=='d1'">

                <div class="row filerow" v-for="item in files_d1">
                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-4">
                        <img class="img-response filethumbnail" :src="GetfileName(item.thumbnailImg,item.Type)" />
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                        <h5 v-text="item.FileName"></h5>
                        <p style="font-size:14px" v-text="item.Information"></p>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6">
                        <button class="orderbtn thm-btn" @@click="downloadfile(item.Path,item.FileName,item.Type)">{{ProductDownloadButton}}</button>
                    </div>
                </div>




            </div>

            <div v-if="activeName=='d2'" class="row">
                <div class="col-lg-2 col-md-2 col-sm-2">
                    <img class="img-response" style="width:80%;max-width:300px" src="/resourse/Img/2D_icon.png" />

                </div>
                <div class="col-lg-4 col-md-4 col-sm-4">
                    <div style="margin-bottom:15px;" v-for="item in files_d2_2D">
                        <h5 v-text="item.FileName"></h5>
                        <button class="orderbtn thm-btn" @@click="downloadfile(item.Path,item.FileName,item.Type)">{{ProductDownloadButton}}</button>
                    </div>


                </div>
                <div class="col-lg-2 col-md-2 col-sm-2">
                    <img class="img-response" style="width:80%;max-width:300px" src="/resourse/Img/3D_icon.png" />
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4">
                    <div style="margin-bottom:15px;" v-for="item in files_d2_3D">
                        <h5 v-text="item.FileName"></h5>
                        <button class="orderbtn thm-btn" @@click="downloadfile(item.Path,item.FileName,item.Type)">{{ProductDownloadButton}}</button>
                    </div>


                </div>
            </div>


            <div v-if="activeName=='d3'">
                <div class="row filerow" v-for="item in files_d3">
                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-4">
                        <img class="img-response filethumbnail" :src="GetfileName(item.thumbnailImg,item.Type)" />
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                        <h5 v-text="item.FileName"></h5>
                        <p style="font-size:14px" v-text="item.Information"></p>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6">
                        <button class="orderbtn thm-btn" @@click="downloadfile(item.Path,item.FileName,item.Type)">{{ProductDownloadButton}}</button>
                    </div>
                </div>



            </div>

            <div v-if="activeName=='d4'">
                <div class="row filerow" v-for="item in files_d4">
                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-4">
                        <img class="img-response filethumbnail" :src="GetfileName(item.thumbnailImg,item.Type)" />
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                        <h5 v-text="item.FileName"></h5>
                        <p style="font-size:14px" v-text="item.Information"></p>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6">
                        <button class="orderbtn thm-btn" @@click="downloadfile(item.Path,item.FileName,item.Type)">{{ProductDownloadButton}}</button>
                    </div>
                </div>



            </div>
        </div>
    </section>
</div>

<!-- 二维码vue js -->
<script type="text/javascript" src="//static.runoob.com/assets/qrcode/qrcode.min.js"></script>
<script>
    //构造二维码
    function initQRCode(divid, qrvalue) {
        var qrcode = new QRCode(document.getElementById(divid), {
            text: qrvalue,
            width: 128,
            height: 128,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: 0 // 二维码结构复杂性 0~3
        });
    }
</script>

<script>
    var OfficeStandards = new Vue({
        el: '#OfficeStandards',
        data: {
            OrderValue: "",
            Order: 0,//1正序 2倒序
            domain: "@ViewBag.domain",
            Type: "@ViewBag.Type",
            recommend: "@ViewBag.recommend",
            langCode:"",
            deskList: null,
            activeName: 'd2',
            productName: '@ViewBag.productName',
            productGuid: '@ViewBag.productGuid',
            deskSerialName:'',
            T_Product_office_desk: null,
            T_Product_office_desk_detail: null,
            descriptions: null,//关键参数
            configurationNo: "",
            introduction: "",
            //文件
            files_d1: [],
            isCollect: false,
            //尺寸图
            files_d2_2D: [],
            files_d2_3D: [],
            //认证
            files_d3: [],

            //文件资料
            files_d4: [],

            //text
            text_detail_1: "",
            text_detail_2: "",
            text_detail_3: "",
            text_detail_4: "",
            text_detail_5: "",
            text_detail_6: "",
            text_detail_7: "",
            text_detail_8: "",
            text_detail_9: "",
            text_detail_10: "",
            text_detail_11: "",
            text_detail_12: "",
            text_detail_13: "",
            text_detail_14: "",
            text_detail_15: "",
            text_detail_16:"",
            text_detail_17: "",
            text_detail_18:"",
            MyCollectName: "",
            paramTableData: [],
            NAVMainPage: "",
            NAVOfficePage: "",
            NAVProductDetailPage: "",
            ProductConfigurationList: "",
            ProductConfigurationCustomButton: "",
            ProductExportConfigurationButton: "",
            ProductFilesAndDesc: "",
            ProductDownloadButton: "",
            ProductCollectSuccess: "",
            ProductCollectFail: "",
            ProductCollectCancelSuccess: "",
            ProductCollectCancelFail: "",
            ProductDetailLength: "",
            ProductDetailLoad: "",
            ProductDetailSpeed: "",
        },
        //watch: {
        //    OrderValue: function (val) {
        //        this.getallDesk();
        //    },
        //    Order: function (val) {
        //        this.getallDesk();
        //    }
        //},
        methods: {
            handleClick(tab, event) {

            },
            GetfileName: function (fname, type) {
                //if (fname == "") {

                //    var str = type;
                //    if (str.indexOf("doc") != '-1');
                //    {
                //        return "/resourse/Img/word_icon.png";
                //    }
                //    if (str.indexOf("xls") != '-1');
                //    {
                //        return "/resourse/Img/excel_icon.png";
                //    }
                //     return "/resourse/Img/pdf_icon.png";
                //}

              //  console.log(fname);
                return fname;
            },
            CollectDesk: function () {
                this.$http({           //调用接口
                    method: 'POST',
                    url: "/JCSelection/CollectDesk",
                    params: {
                        deskId: this.T_Product_office_desk.Id,
                    }
                }).then(function (response) {  //接口返回数据
                    if (response.body > 0) {
                        this.$notify({
                            message: this.ProductCollectSuccess,
                            type: 'success'
                        });
                        this.isCollect = true;
                    }
                    else {
                        this.$notify.error(this.ProductCollectFail);
                        this.isCollect = false;
                    }
                }, function (error) {
                    console.log(error);
                })
            },
            CancelCollectDesk: function() {
                this.$http({           //调用接口
                    method: 'POST',
                    url: "/JCSelection/CancelCollectDesk",
                    params: {
                        deskId: this.T_Product_office_desk.Id,
                    }
                }).then(function (response) {  //接口返回数据
                    if (response.body > 0) {
                        this.$notify({
                            message: this.ProductCollectCancelSuccess,
                            type: 'success'
                        });
                        this.isCollect = false;
                    }
                    else {
                        this.$notify.error(this.ProductCollectCancelFail);
                        this.isCollect = true;
                    }
                }, function (error) {
                    console.log(error);
                })
            },



            exportConfig: function (event) {

                var doc = new jsPDF('p', 'pt');          // 初始化示例，更多配置项看官网api

                //doc.addFont('msyh.ttf', 'msyh', 'normal');
                doc.setFont('msyh');
                doc.text("JIECANG Office Configuration", 40, 50);           // 表title、距离左边距离、距离上边距离
                var res = doc.autoTableHtmlToJson(document.getElementById("paramTB"));
               // console.log(res);
                doc.autoTable(res.columns, res.data, { startY: 60 });    // 渲染数据，列、数据、距离上边距离，更多配置项看官网api

                doc.save('tableName.pdf');    // 导出名为tableName.pdf的文件

            },
            downloadfile: function (url,fname,type) {

                if (type == ".dwg" || type ==".stp") {
                    fname = fname + type;
                }


                console.log(url);
                //window.open(url);   //该方法只能下载比如xls等不能直接打开的文件，对于png之类的文件会直接打开而非下载

                const link = document.createElement('a');
                link.style.display = 'none';
                link.href = url;
                link.setAttribute('download', fname);
                document.body.appendChild(link);
                link.click();
            },
            gotoCustmer: function (event) {
                window.location = "/JCSelection/office_Eservice_test?domain=@ViewBag.domain&Type=@ViewBag.Type&recommend=@ViewBag.recommend&productName=@ViewBag.productName&productGuid=@ViewBag.productGuid";
            },
            initPage: function (event) {
                var code = GetLanguCode();
                this.langCode = code;
                $.ajaxSettings.async = false;
                var languText;
                $.getJSON("/resourse/Language/text-" + code + ".json", function (result) {
                    languText = result.language;
                });
                $.ajaxSettings.async = true;
                var obj = languText;
                for (var p in obj) {
                    // 方法
                    if (typeof (obj[p]) == "function") {
                        obj[p]();
                    } else {
                        // p 为属性名称，obj[p]为对应属性的值
                        var key = p;
                        var value = obj[p];
                       // console.log('key:' + key + "  value:" + value);
                        this.setData(key, value);;
                    }
                }
                

            },
            getThisDesk: function (event) {
                //文件列表
                //var fitem = { filethumbnail: '/resourse/office/fileimg.png', fileName: 'VUE的和CBD6S使用手册可下载pdf', fileDes: '本使用手册将会告诉您如何安装,使用并维护您的产品' };
                //this.files_d1.push(fitem);


                //获取桌子详细信息
                this.$http({           //调用接口
                    method: 'GET',
                    url: "/JCSelection/GetOfficeDeskDetail",
                    params: {
                        lang: this.langCode,
                        productGuid: this.productGuid,

                    }
                }).then(function (response) {  //接口返回数据

                    var column = "";
                    var frame = "";
                    var foot = "";
                    var control = "";
                    var handset = "";
                    var side = "";
                    var color = "";
                   // this.deskList = response.body;
                    this.T_Product_office_desk = response.body.T_Product_office_desk;
                    this.T_Product_office_desk_detail = response.body.T_Product_office_desk_detail;
                    //this.descriptions = response.body.descriptions;

                    this.deskSerialName = this.T_Product_office_desk.deskSerialName;
                    this.configurationNo = this.T_Product_office_desk_detail.configurationNo;
                    //this.introduction = this.T_Product_office_desk_detail.introduction;

                    //添加到产品配置列表 立柱
                    if (this.T_Product_office_desk_detail.T_Part_office_Column != null) {

                        //立柱的参数表
                        var it = this.T_Product_office_desk_detail.T_Part_office_Column;
                        var paramList = new Array();
                        var statelist = new Array();
                        //if (it.Type != '') {
                        //    statelist.push("安装方向：" + it.Type);
                        //}
                        //if (it.Level != '') {
                        //    statelist.push("节数：" + it.Level);
                        //}
                        //if (it.Form != '') {
                        //    statelist.push("管形形状：" + it.Form);
                        //}

                        if (it.StrokeLength != '') {
                            statelist.push(this.ProductDetailLength+"：" + it.StrokeLength);
                        }
                        //if (it.MaxStroke != '') {
                        //    statelist.push("最大行程：" + it.MaxStroke);
                        //}
                        if (it.LoadCapacity != '') {
                            statelist.push(this.ProductDetailLoad+"：" + it.LoadCapacity);
                        }
                        //if (it.MaxLoad != '') {
                        //    statelist.push("最大负载：" + it.MaxLoad);
                        //}
                        if (it.Speed != '') {
                            statelist.push(this.ProductDetailSpeed+"：" + it.Speed);
                        }
                        this.descriptions = statelist;
                        for (i in this.T_Product_office_desk_detail.T_Part_office_Column.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_Column.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_11, model: this.T_Product_office_desk_detail.T_Part_office_Column.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_Column.PictureName, paramList: paramList };
                        this.paramTableData.push(q);
                        column = it.Mode;
                    }
                    //添加到产品配置列表
                    if (this.T_Product_office_desk_detail.T_Part_office_Foot != null) {

                        var it = this.T_Product_office_desk_detail.T_Part_office_Foot;
                        var paramList = new Array();
                        //if (it.MaxLength != '') {
                        //    paramList.push("最大长度：" + it.MaxLength);
                        //}
                        //if (it.MinLength != '') {
                        //    paramList.push("最小长度：" + it.MinLength);
                        //}

                        for (i in this.T_Product_office_desk_detail.T_Part_office_Foot.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_Foot.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_12, model: this.T_Product_office_desk_detail.T_Part_office_Foot.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_Foot.PictureName, paramList:paramList };
                        this.paramTableData.push(q);
                        foot = it.Mode;
                    }
                    //添加到产品配置列表
                    if (this.T_Product_office_desk_detail.T_Part_office_Frame != null) {

                        var it = this.T_Product_office_desk_detail.T_Part_office_Frame;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Part_office_Frame.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_Frame.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_13, model: this.T_Product_office_desk_detail.T_Part_office_Frame.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_Frame.PictureName, paramList:paramList };
                        this.paramTableData.push(q);
                        frame = it.Mode;
                    }
                    //添加到产品配置列表
                    if (this.T_Product_office_desk_detail.T_Part_office_SideBracket != null) {
                        var it = this.T_Product_office_desk_detail.T_Part_office_SideBracket;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Part_office_SideBracket.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_SideBracket.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_14, model: this.T_Product_office_desk_detail.T_Part_office_SideBracket.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_SideBracket.PictureName, paramList:paramList};
                        this.paramTableData.push(q);
                        side = it.Mode;
                    }
                    if (this.T_Product_office_desk_detail.T_Part_office_ControlBox != null) {
                        var it = this.T_Product_office_desk_detail.T_Part_office_ControlBox;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Part_office_ControlBox.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_ControlBox.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_15, model: this.T_Product_office_desk_detail.T_Part_office_ControlBox.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_ControlBox.PictureName, paramList: paramList };
                        this.paramTableData.push(q);
                        control = it.Mode;
                    }
                    if (this.T_Product_office_desk_detail.T_Part_office_HandSet != null) {
                        var it = this.T_Product_office_desk_detail.T_Part_office_HandSet;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Part_office_HandSet.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_HandSet.T_Part_office_describes[i].textValue);
                        }

                        var q = { part: this.text_detail_16, model: this.T_Product_office_desk_detail.T_Part_office_HandSet.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_HandSet.PictureName, paramList: paramList };
                        this.paramTableData.push(q);
                        handset = it.Mode;
                    }
                    if (this.T_Product_office_desk_detail.T_Part_office_Powercable != null) {
                        var it = this.T_Product_office_desk_detail.T_Part_office_Powercable;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Part_office_Powercable.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Part_office_Powercable.T_Part_office_describes[i].textValue);
                        }
                        //console.log(this.T_Product_office_desk_detail.T_Part_office_Powercable);
                        var q = { part: this.text_detail_17, model: this.T_Product_office_desk_detail.T_Part_office_Powercable.Mode, name: '', tag: this.T_Product_office_desk_detail.T_Part_office_Powercable.PictureName, paramList: paramList };
                        this.paramTableData.push(q);
                    }
                    if (this.T_Product_office_desk_detail.T_Office_Color != null) {
                        var it = this.T_Product_office_desk_detail.T_Office_Color;
                        var paramList = new Array();

                        for (i in this.T_Product_office_desk_detail.T_Office_Color.T_Part_office_describes) {
                            paramList.push(this.T_Product_office_desk_detail.T_Office_Color.T_Part_office_describes[i].textValue);
                        }
                        var q = { part: this.text_detail_18, model: this.T_Product_office_desk_detail.T_Office_Color.ColorName, name: '1', tag: this.T_Product_office_desk_detail.T_Office_Color.HEXValue, paramList: paramList };
                        this.paramTableData.push(q);
                        color = it.ColorNumber;
                    }

                    initQRCode('qrcodebox', this.configurationNo);

                   // console.log(this.T_Product_office_desk_detail);

                    var ni = 0;
                    for (ni in response.body.T_Office_Files) {
                        var item = response.body.T_Office_Files[ni];
                        switch (item.Nature) {

                            case "产品介绍": this.files_d1.push(item); break;

                            case "产品图2D": this.files_d2_2D.push(item); break;
                            case "产品图3D": this.files_d2_3D.push(item); break;

                            case "认证": this.files_d3.push(item); break;

                            case "文件资料": this.files_d4.push(item); break;
                            default:
                        }

                    }

                    //收藏的逻辑
                    if (response.body.collect!=null&&response.body.collect.Id > 0) {
                        this.isCollect = true;
                    }
                    var url = checkProductDetailUrl(column,frame,foot,side,control, handset, color);
                    console.log(url);
                    var i = '<iframe scrolling="no"  id="shjahs"  alt=""  src = "' + url + "&languageIso=" + this.langCode+'"/>';
                    $('#asas').append(i);
                    //console.log(response.body);


                }, function (error) {
                        console.log(error);


                })
            },
            orderBtnClick: function (ordervalue) {

                this.OrderValue = ordervalue;
                if (this.Order == 1) {
                    this.Order = 2;
                }
                else {
                    this.Order = 1;
                }
            },

            setData: function (field, val) {
                this.$set(this.$data, field, val);//vue 设定值
            },
            download() {
                var element = $("#pdfDom");    // 这个dom元素是要导出pdf的div容器
                var w = element.width();    // 获得该容器的宽
                var h = element.height();    // 获得该容器的高
                var offsetTop = element.offset().top;    // 获得该容器到文档顶部的距离
                var offsetLeft = element.offset().left;    // 获得该容器到文档最左的距离
                var canvas = document.createElement("canvas");
                var abs = 0;
                var win_i = $(window).width();    // 获得当前可视窗口的宽度（不包含滚动条）
                var win_o = window.innerWidth;    // 获得当前窗口的宽度（包含滚动条）
                if (win_o > win_i) {
                    abs = (win_o - win_i) / 2;    // 获得滚动条长度的一半
                }
                canvas.width = w * 2;    // 将画布宽&&高放大两倍
                canvas.height = h * 2;
                var context = canvas.getContext("2d");
                context.scale(2, 2);
                context.translate(-offsetLeft - abs, -offsetTop);
                // 这里默认横向没有滚动条的情况，因为offset.left(),有无滚动条的时候存在差值，因此        
                // translate的时候，要把这个差值去掉
                html2canvas(element, {background:'#FFF'}).then(function (canvas) {
                    var contentWidth = canvas.width;
                    var contentHeight = canvas.height;
                    //一页pdf显示html页面生成的canvas高度;
                    var pageHeight = contentWidth / 592.28 * 841.89;
                    //未生成pdf的html页面高度
                    var leftHeight = contentHeight;
                    //页面偏移
                    var position = 0;
                    //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
                    var imgWidth = 595.28;
                    var imgHeight = 592.28 / contentWidth * contentHeight;

                    var pageData = canvas.toDataURL('image/jpeg', 1.0);

                    var pdf = new jsPDF('', 'pt', 'a4');

                    //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
                    //当内容未超过pdf一页显示的范围，无需分页
                    if (leftHeight < pageHeight) {
                        pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
                    } else {    // 分页
                        while (leftHeight > 0) {
                            pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
                            leftHeight -= pageHeight;
                            position -= 841.89;
                            //避免添加空白页
                            if (leftHeight > 0) {
                                pdf.addPage();
                            }
                        }
                    }
                    pdf.save('111.pdf');
                })
            }
        }
    })
    //语言加载
    OfficeStandards.initPage();
    OfficeStandards.getThisDesk();
</script>




